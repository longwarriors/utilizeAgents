# 基于Python的自动化专利生成系统 (受 AutoPatent 启发)

本项目旨在开发一个用于自动化生成专利文件的Python应用程序。其设计灵感来源于 "AutoPatent" (arXiv:2412.09796) 等研究中提出的多智能体框架和核心概念，包括结构化规划方法（类似于专利生成树 - `PGTree`）和用于审查的检索增强生成技术 (`RRAG`)。

## 项目目标

创建一个健壮、模块化的Python系统，能够接收初始的发明构思或草稿，并通过一系列智能代理和结构化工作流程，逐步生成一份完整的专利申请文件。

## 核心模块与功能

本应用主要由以下关键模块构成：

-   **`agents/` (智能体目录)**: 包含负责专利生成不同阶段的AI智能体。
    -   `planner_agent.py` (规划智能体):
        -   **职责**: 接收发明的初始概念或高级描述。
        -   **核心功能**: 为专利文档生成一个详细的、层级化的规划方案。此方案被称为 **专利生成树 (`PGTree`)**，它将概述所有必要章节（例如：发明名称、摘要、背景技术、发明内容、具体实施方式、权利要求书、附图说明等）及其子组件或需要阐述的关键点。
    -   `writer_agent.py` (编写智能体):
        -   **职责**: 草拟专利的文本内容。
        -   **核心功能**: 接收由 `PlannerAgent` 生成的 `PGTree`。根据 `PGTree` 中每个节点/章节的要求，填充编写格式良好、技术准确且符合法律规范的文本内容。在未来的迭代中，可能会包含一个或多个专门的编写智能体。
    -   `examiner_agent.py` (审查智能体, 原 `reviewer_agent.py`):
        -   **职责**: 严格审查并完善已草拟的专利内容。
        -   **核心功能**:
            -   评估草稿的清晰度、完整性、一致性以及是否符合专利标准。
            -   实现 **检索增强生成审查 (`RRAG`)** 机制。这包括：
                1.  识别草稿中需要与现有技术进行验证或比较的关键声明或技术点。
                2.  向 `PatentDB` (以及潜在的外部专利数据库或技术文献库) 发起检索请求，查找相关文档。
                3.  利用检索到的信息评估草稿的新颖性、创造性及潜在问题，并提供可操作的修改建议。
    -   `base_agent.py` (基础智能体): (可选) 为所有智能体定义通用接口和功能的基础类。

-   **`database/` (数据库目录)**: 管理专利数据及相关知识的存储、检索和搜索。
    -   `patent_db.py` (专利数据库接口):
        -   **职责**: 处理与专利数据库的所有交互。
        -   **核心功能**:
            -   存储生成的专利草稿、`PGTree` 结构及相关的元数据。
            -   提供强大的 **搜索和检索能力**，以支持 `ExaminerAgent` 的 `RRAG` 过程。这包括关键词搜索，以及未来可能实现的基于专利分类的语义搜索或筛选。
    -   `models.py` (数据模型): 定义数据库的数据结构和模式 (例如，使用像SQLAlchemy这样的ORM)。

-   **`coordinator/` (协调器目录)**: 编排整体工作流程以及智能体与其他模块间的交互。
    -   `coordinator.py` (协调器):
        -   **职责**: 管理端到端的专利生成过程。
        -   **核心功能**:
            -   通过 `PlannerAgent` 创建 `PGTree` 来启动流程。
            -   将 `PGTree` 传递给 `WriterAgent` 进行草拟。
            -   将草稿提交给 `ExaminerAgent` 进行审查。
            -   基于 `ExaminerAgent` 的反馈，管理修订和审查的迭代循环，可能需要重新调用 `WriterAgent`。
            -   追踪专利生成任务的状态和进度。

-   **`utils/` (工具模块目录)**: 包含整个项目中使用的实用函数和辅助类。
    -   `token_tracker.py` (Token追踪器): 如果直接集成LLM，则用于监控和管理语言模型的Token使用情况。
    -   `pg_tree_handler.py` (PGTree处理器): (可选) 如果 `PGTree` 的逻辑变得复杂，此模块可以提供用于创建、操作和遍历 `PGTree` 数据结构的专用功能。

-   **`main.py`**: 初始化和运行应用程序的主入口点。
-   **`requirements.txt`**: 列出项目依赖项 (例如, LLM SDK, 数据库连接器, 文本处理库等)。

## 工作流程概述

1.  **启动**: 用户提供一个初始的发明构思。
2.  **规划**: `PlannerAgent` 构建一个 `PGTree`，详细说明专利的结构和内容要求。
3.  **草拟**: `WriterAgent` 根据 `PGTree` 的每个部分填充草拟文本。
4.  **审查与 `RRAG`**: `ExaminerAgent` 审查草稿。它通过 `RRAG` 机制，查询 `PatentDB` 以获取相关的现有技术和技术信息，从而为其评估提供信息支持。
5.  **反馈与修订**: `ExaminerAgent` 提供反馈。如果需要修订，`Coordinator` 会将草稿和反馈意见交回给 `WriterAgent`。
6.  **迭代**: 步骤3-5可能会重复进行，直到 `ExaminerAgent` 批准草稿。
7.  **定稿**: 经批准的专利文件最终完成。

## 安装与设置

1.  克隆本仓库。
2.  建立Python虚拟环境。
3.  安装依赖项:
    ```bash
    pip install -r requirements.txt
    ```
    (请确保 `requirements.txt` 文件中已包含所有必要的库，例如 `openai`, `langchain`, `sqlalchemy`, 以及用于高级搜索的 `faiss-cpu` 或 `elasticsearch` 等。)

## 使用方法

运行主应用程序脚本:
```bash
python main.py
```
这通常会触发一个预定义的专利生成工作流程，或提供一个用于启动专利生成任务的交互界面。

## 未来展望与增强

-   与大型语言模型 (`LLM`) 深度集成，以实现高级文本生成和理解能力。
-   连接外部公共专利数据库 (例如, USPTO, EPO, Google Patents)。
-   开发用户友好的交互界面。
-   实现更复杂的 `PGTree` 结构和生成逻辑。
-   为不同的专利部分（如权利要求书、说明书）开发专门的编写智能体。
